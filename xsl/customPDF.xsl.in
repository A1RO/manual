<?xml version='1.0' ?>

<xsl:stylesheet  
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:fo="http://www.w3.org/1999/XSL/Format"
    version="1.0">

<xsl:import href="@xsl_base_path@/fo/docbook.xsl"/>

<xsl:param name="fop1.extensions" select="1" />

<xsl:param name="chunk.section.depth" select="2" />
<xsl:param name="use.id.as.filename" select="1" />
<xsl:param name="chunker.output.indent" select="'yes'" />
<xsl:param name="toc.section.depth" select="2" /> 
<xsl:param name="refentry.generate.name" select="0" />
<xsl:param name="refentry.generate.title" select="1" />
<xsl:param name="chapter.autolabel" select="0" />
<xsl:param name="admon.graphics" select="1" />

<!-- <xsl:param name="html.stylesheet" select="'blue.css'"/> -->
<!-- <xsl:param name="chunk.first.sections" select="1" /> -->
<!-- <xsl:param name="section.autolabel" select="1" /> -->
<!--<xsl:param name="section.label.includes.component.label" select="1" /> -->
<!-- <xsl:param name="navig.graphics" select="1" /> -->

<xsl:param name="generate.toc">
appendix  toc,title
article/appendix  nop
article   toc,title
book      toc,title <!--,figure,table,example,equation -->
chapter   title <!-- toc, -->
part      toc,title
preface   toc,title
qandadiv  toc
qandaset  toc
reference toc,title
sect1     toc
sect2     toc
sect3     toc
sect4     toc
sect5     toc
section   toc
set       toc,title
</xsl:param>

<!-- monospace fonts smaller -->
<xsl:attribute-set name="monospace.properties">
  <xsl:attribute name="font-family">
    <xsl:value-of select="$monospace.font.family"/>
  </xsl:attribute>
  <xsl:attribute name="font-size">8pt</xsl:attribute>
</xsl:attribute-set>

<!-- rules for quickref -->
<xsl:template match="chapter/formalpara/para/synopsis">
  <xsl:variable name="id"><xsl:call-template name="object.id"/></xsl:variable>
  <xsl:variable name="content">
    <xsl:apply-templates mode="quickref"/>
  </xsl:variable>
  <fo:block id="{$id}"
    white-space-collapse='false'
    white-space-treatment='preserve'
    linefeed-treatment="preserve"
    text-align="left"
    xsl:use-attribute-sets="monospace.properties">
    <xsl:copy-of select="$content"/>
  </fo:block>
</xsl:template>

<xsl:template match="link" mode="quickref">
  <xsl:element name="fo:basic-link">
    <xsl:attribute name="internal-destination"><xsl:value-of select="@linkend"/></xsl:attribute>
    <xsl:element name="fo:inline">
      <xsl:attribute name="color"><xsl:value-of select="'blue'"/></xsl:attribute>
      <xsl:attribute name="font-weight"><xsl:value-of select="'bold'"/></xsl:attribute>
      <xsl:apply-templates/>
    </xsl:element>
  </xsl:element>
</xsl:template>

<!--
Rules for syntax highlighting, based on Pygmentsâ€™ lovelace style:
https://bitbucket.org/birkenfeld/pygments-main/src/default/pygments/styles/lovelace.py
-->
<xsl:template match="emphasis[starts-with(@role, 'k')]"> <!-- Keyword -->
  <fo:inline color="#2838b0"><xsl:apply-templates/></fo:inline>
</xsl:template>

<xsl:template match="emphasis[@role = 'na']"> <!-- Name.Attribute -->
  <fo:inline color="#388038"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'nb']"> <!-- Name.Builtin -->
  <fo:inline color="#388038"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'bp']"> <!-- Name.Builtin.Pseudo -->
  <fo:inline color="#388038" font-style="italic"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'nc']"> <!-- Name.Class -->
  <fo:inline color="#287088"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'no']"> <!-- Name.Constant -->
  <fo:inline color="#b85820"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'nd']"> <!-- Name.Decorator -->
  <fo:inline color="#287088"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'ni']"> <!-- Name.Entity -->
  <fo:inline color="#709030"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'ne']"> <!-- Name.Exception -->
  <fo:inline color="#908828"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'nf']"> <!-- Name.Function -->
  <fo:inline color="#785840"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'fm']"> <!-- Name.Function.Magic -->
  <fo:inline color="#b85820"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'nl']"> <!-- Name.Label -->
  <fo:inline color="#289870"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'nn']"> <!-- Name.Namespace -->
  <fo:inline color="#289870"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'nt']"> <!-- Name.Tag -->
  <fo:inline color="#2838b0"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'nv']"> <!-- Name.Variable -->
  <fo:inline color="#b04040"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'vg']"> <!-- Name.Variable.Global -->
  <fo:inline color="#908828"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'vi']"> <!-- Name.Variable.Instance -->
  <fo:inline color="#b04040"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'vm']"> <!-- Name.Variable.Magic -->
  <fo:inline color="#b85820"><xsl:apply-templates/></fo:inline>
</xsl:template>

<xsl:template match="emphasis[@role = 's']"> <!-- String -->
  <fo:inline color="#b83838"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'sa']"> <!-- String.Affix -->
  <fo:inline color="#444444"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'sb']"> <!-- String.Backtick -->
  <fo:inline color="#b83838"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'sc']"> <!-- String.Char -->
  <fo:inline color="#a848a8"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'dl']"> <!-- String.Delimiter -->
  <fo:inline color="#b85820"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'sd']"> <!-- String.Doc -->
  <fo:inline color="#b85820" font-style="italic"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 's2']"> <!-- String.Double -->
  <fo:inline color="#b83838"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'se']"> <!-- String.Escape -->
  <fo:inline color="#709030"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'sh']"> <!-- String.Heredoc -->
  <fo:inline color="#b83838"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'si']"> <!-- String.Interpol -->
  <fo:inline color="#b83838"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'sx']"> <!-- String.Other -->
  <fo:inline color="#a848a8"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'sr']"> <!-- String.Regex -->
  <fo:inline color="#a848a8"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 's1']"> <!-- String.Single -->
  <fo:inline color="#b83838"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'ss']"> <!-- String.Symbol -->
  <fo:inline color="#b83838"><xsl:apply-templates/></fo:inline>
</xsl:template>

<xsl:template match="emphasis[starts-with(@role, 'm') || @role = 'il']"> <!-- Number -->
  <fo:inline color="#444444"><xsl:apply-templates/></fo:inline>
</xsl:template>

<xsl:template match="emphasis[@role = 'o']"> <!-- Operator -->
  <fo:inline color="#666666"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'ow']"> <!-- Operator.Word -->
  <fo:inline color="#a848a8"><xsl:apply-templates/></fo:inline>
</xsl:template>

<xsl:template match="emphasis[@role = 'p']"> <!-- Punctuation -->
  <fo:inline color="#888888" font-style="italic"><xsl:apply-templates/></fo:inline>
</xsl:template>

<xsl:template match="emphasis[@role = 'c']"> <!-- Comment -->
  <fo:inline color="#888888" font-style="italic"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'ch']"> <!-- Comment.Hashbang -->
  <fo:inline color="#287088" font-style="italic"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'cm']"> <!-- Comment.Multiline -->
  <fo:inline color="#888888" font-style="italic"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'cp']"> <!-- Comment.Preproc -->
  <fo:inline color="#289870""><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'c1']"> <!-- Comment.Single -->
  <fo:inline color="#888888" font-style="italic"><xsl:apply-templates/></fo:inline>
</xsl:template>
<xsl:template match="emphasis[@role = 'cs']"> <!-- Comment.Special -->
  <fo:inline color="#888888" font-style="italic"><xsl:apply-templates/></fo:inline>
</xsl:template>

</xsl:stylesheet>
